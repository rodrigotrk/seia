<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.prime.com.tr/ui">	
	
		<p:confirmDialog message="#{bundle.consultapf_msg_confimrexclusao}" width="200" header="Mensagem" severity="alert" widgetVar="confirmationDocumento">
			<h:form>
        <ui:include src="/layout/csrfToken.xhtml" />
				<p:commandButton value="Sim" update=":tabviewpj:tabviewreplegal:formdocumentos:paneltabledocreplegal"
					actionListener="#{documentoIdentificacaoController.removerDocumentoRepresentanteLegal()}"
					oncomplete="confirmationDocumento.hide()" process="@this" />
				
        <ui:include src="/layout/csrfToken.xhtml" />
				<p:commandButton value="Não" onclick="confirmationDocumento.hide()"
					type="button" />
			</h:form>
		</p:confirmDialog>		
		
		<p:dialog id="dialogdocumentos" widgetVar="dialogdocumentos"			
			header="Documento" resizable="false" modal="true" position="center center" onShow="dialogdocumentos.initPosition()">
			<h:form id="formdocumentos">
				<h:panelGrid id="paneldocumentos" columns="1">
					<h:panelGrid columns="2">
							<h:outputLabel value="*Tipo de Documento" />
							<h:outputLabel value="*Número de Documento" />
							<p:selectOneMenu style="width: 260px;" id="tipoDocumento"
								disabled="#{!documentoIdentificacaoController.editModeDocumento}"
								value="#{documentoIdentificacaoController.documentoIdentificacaoSelecionado.ideTipoIdentificacao}"
								valueChangeListener="#{documentoIdentificacaoController.listenerValor}" required="true" requiredMessage="O campo Tipo de Documento é de preenchimento obrigatório.">
								<f:selectItem itemLabel="Selecione..." />
								<f:selectItems value="#{tipoIdentificacaoController.valuesComboBox}" />
								<f:converter converterId="tipoIdentificacaoConverter" />
								<f:ajax render="paneldocumentos" />
								<p:ajax event="change" listener="#{documentoIdentificacaoController.carregarComboOrgaoExp(false)}" update=":formdocumentos" process="@this"/>
							</p:selectOneMenu>
							<p:inputText style="width: 136px;" id="numDocumento" required="true" requiredMessage="O campo Número de Documento é de preenchimento obrigatório"
								value="#{documentoIdentificacaoController.documentoIdentificacaoSelecionado.numDocumento}" maxlength="15"
								disabled="#{!documentoIdentificacaoController.editModeDocumento}" />
					</h:panelGrid>
					<h:panelGrid columns="2">
						<h:outputText value="*Orgão Emissor" />
						<h:outputText value="*UF:" rendered="#{!documentoIdentificacaoController.campoSerie}"/>
						<h:outputText value="*Série:" rendered="#{documentoIdentificacaoController.campoSerie}" />
						<p:selectOneMenu style="width: 260px;" id="orgaoEmissor" value="#{documentoIdentificacaoController.documentoIdentificacaoSelecionado.ideOrgaoExpedidor}"
							disabled="#{documentoIdentificacaoController.desabCombOrg}" required="true" requiredMessage="O campo Orgão Emissor é de preenchimento obrigatório." >		
							<f:selectItem itemLabel="Selecione..." />
							<f:selectItems value="#{documentoIdentificacaoController.listaOrgaoExpedidor}" var="orgao" itemLabel="#{orgao.dscOrgaoExpedidor}" itemValue="#{orgao}" />
							<f:converter converterId="OrgaoExpedidorConverter" />					
						</p:selectOneMenu>

						<p:inputText title="Série" maxlength="15" value="#{documentoIdentificacaoController.documentoIdentificacaoSelecionado.numSerie}" rendered="#{documentoIdentificacaoController.campoSerie}" 
						 required="true" style="width: 136px;" requiredMessage="O campo Número de série é de preenchimento obrigatório" disabled="#{!documentoIdentificacaoController.editModeDocumento}" />
						<h:outputText value="*UF:" rendered="#{documentoIdentificacaoController.campoSerie}"  />
						<h:outputText value="" rendered="#{documentoIdentificacaoController.campoSerie}" />
						
						<p:selectOneMenu style="width: 143px;" id="uforgaoemissor"
							value="#{documentoIdentificacaoController.documentoIdentificacaoSelecionado.ideEstado}"
							disabled="#{!documentoIdentificacaoController.editModeDocumento}" required="true" requiredMessage="O campo UF é de preenchimento obrigatório." >
							<f:selectItem  itemLabel="Selecione..." />
							<f:selectItems value="#{documentoIdentificacaoController.listaEstados}" var="estado" itemLabel="#{estado.desSigla}" itemValue="#{estado}" />
							<f:converter converterId="estadoConverter" />
						</p:selectOneMenu>
					</h:panelGrid>

					<h:panelGrid columns="2">
						<h:outputText value="*Data de Emissão" />
						<h:outputText value="Data de Validade" />

						<h:panelGroup>
						<h:outputText value="De   " />
						<p:calendar showOn="button" id="dataEmissao" label="Data de Emissão" validator="dataPosteriorValidator"
							value="#{documentoIdentificacaoController.documentoIdentificacaoSelecionado.dtcEmissao}"
							locale="pt" pattern="dd/MM/yyyy" navigator="true"	
							disabled="#{!documentoIdentificacaoController.editModeDocumento}" required="true" requiredMessage="O campo Data de Emissão é de preenchimento obrigatório"  
							readOnlyInputText="true" yearRange="c-100" maxdate="#{documentoIdentificacaoController.dataAtual}"
						/>
						<h:outputText value="   Até" />
						</h:panelGroup>
						<p:calendar showOn="button" id="dataValidade" style="margin-left:-25px"
							value="#{documentoIdentificacaoController.documentoIdentificacaoSelecionado.dtcValidade}"
							locale="pt" pattern="dd/MM/yyyy" 
							  navigator="true" disabled="#{!documentoIdentificacaoController.editModeDocumento}"
							readOnlyInputText="true" yearRange="c-100:c+100" mindate="#{pessoaFisicaController.dataAtual}"
						/>
						<h:outputText value="*Cópia do Documento (.pdf.jpg - Máximo 5MB)"
							rendered="#{documentoIdentificacaoController.editModeDocumento}" />
						<h:outputText value="" />
					</h:panelGrid>

					<p:fileUpload uploadLabel="false" label="Upload Documento" invalidFileMessage="Tipo de arquivo inválido."
						fileUploadListener="#{documentoIdentificacaoController.trataArquivoRepresentante}"
						mode="advanced" oncomplete="remoteCommandUpdateDataTable()" auto="true"
						allowTypes="/(\.|\/)(pdf|gif|jpeg|png|jpg)$/"
						rendered="#{documentoIdentificacaoController.editModeDocumento}" 
						sizeLimit="5242880" invalidSizeMessage="O tamanho máximo do arquivo não pode ultrapassar 5MB" />
						 <p:remoteCommand name="remoteCommandUpdateDataTable" update="tblDocumento"/> 
				</h:panelGrid>
					<h:panelGrid id="tblDocumento">
						<p:dataTable id="dataTableDocumentos" rendered="#{documentoIdentificacaoController.temArquivoRepresentante}" widgetVar="dtTbDocumentos" value="#{documentoIdentificacaoController.listaArquivoRepresentante}" 
						 var="arquivo" lazy="true" emptyMessage="#{bundle.msg_lista_vazia}" style="width:472px;">
							<p:column>  
								<h:outputText value="#{arquivo}"/>
							</p:column>	
							 <p:column>  
								<h:commandButton value="#{arquivo}"  image="/resources/img/ico-download.png" >
								  <p:fileDownload value="#{documentoIdentificacaoController.arquivoBaixarRepresentante}" />				              
								</h:commandButton>
							</p:column>	
					</p:dataTable>		    
				</h:panelGrid>
				<h:panelGrid columns="4">
				<h:panelGrid columns="2">
					<p:commandButton value="Limpar" id="botaoLimparPf" update="paneldocumentos dataTableDocumentos"
						rendered="#{documentoIdentificacaoController.editModeDocumento}" action="#{documentoIdentificacaoController.limparObjetosDocumento}" process="@this">
					</p:commandButton>
					<p:commandButton value="Salvar" id="botaoSalvar"
						actionListener="#{documentoIdentificacaoController.salvarDocumentoRepresentanteLegal()}"
						update=":formdocumentosLst:tabeladocumentos"	
						oncomplete="dialogdocumentos.hide();"
						rendered="#{documentoIdentificacaoController.editModeDocumento}" 
						ajax="true"/>
				</h:panelGrid>
				</h:panelGrid>
						<h:outputLabel value="#{bundle.lbl_preench_obrig_asterisc}" style="float: left;" />
			</h:form>
		</p:dialog>
		
</ui:composition>
